<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Glitchlet Creative Code Workbench</title>
    <link rel="stylesheet" href="assets/styles.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/lib/codemirror.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/theme/material-darker.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/foldgutter.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/dialog/dialog.css"
    />
  </head>
  <body>
    <div class="app">
      <header class="topbar">
        <div class="brand">
          <div class="brand-mark"></div>
          <div class="brand-text">
            <span class="brand-title">Glitchlet</span>
            <span class="brand-subtitle">
              Creative Coding Workbench
              <button id="aboutBtn" class="icon-btn subtle-icon" title="About Glitchlet">
                <i data-lucide="heart-handshake"></i>
              </button>
            </span>
          </div>
        </div>
        <div class="current-project">
          <span class="current-project-label">Project</span>
          <div class="current-project-row">
            <span id="currentProjectName" class="current-project-name">Untitled Project</span>
            <button
              id="projectMetaBtn"
              class="meta-btn"
              title="Edit project details"
              data-tutorial-title="Project details"
              data-tutorial="Add a title, creator name, and description for publishing."
            >
              <i data-lucide="pencil"></i>
            </button>
          </div>
        </div>
        <div class="topbar-toggles">
          <button
            id="tutorialToggleBtn"
            class="icon-btn"
            title="Toggle tutorial mode"
            data-tutorial-title="Tutorial mode"
            data-tutorial="Turn on guided tips that explain the main controls as you hover."
          >
            <i data-lucide="circle-help"></i>
          </button>
          <button
            id="themeToggleBtn"
            class="icon-btn"
            title="Switch theme mode"
            data-tutorial-title="Theme"
            data-tutorial="Switch between light and dark themes for the overall app."
          >
            <i data-lucide="sun-moon"></i>
          </button>
        </div>
        <div class="actions">
          <div class="project-manager">
            <button
              id="projectManagerBtn"
              class="btn"
              title="Open project manager"
              data-tutorial-title="Project manager"
              data-tutorial="Switch between saved projects, rename them, or start new ones. Import and export ZIPs, including archived Glitch projects."
            >Project Manager</button>
            <div id="projectManagerPanel" class="manager-panel hidden" role="dialog" aria-label="Project manager">
              <div class="manager-header">
                <span>Project Manager</span>
                <button id="closeProjectManagerBtn" class="icon-btn" title="Close">
                  <i data-lucide="x"></i>
                </button>
              </div>
              <div class="manager-section">
                <label class="manager-label" for="projectNameInput">Current project name</label>
                <div class="manager-row">
                  <input id="projectNameInput" class="manager-input" type="text" placeholder="Untitled Project" />
                  <button id="renameProjectBtn" class="btn">Rename</button>
                </div>
                <div class="manager-row">
                  <button id="saveProjectBtn" class="btn">Save</button>
                  <button id="saveProjectAsBtn" class="btn">Save As...</button>
                  <button id="newProjectBtn" class="btn">New Project</button>
                </div>
              </div>
              <div class="manager-section" data-tutorial-title="Project list" data-tutorial="Select a project to load it into the editor.">
                <div class="manager-label">Projects</div>
                <div id="projectList" class="project-list"></div>
              </div>
              <div class="manager-section">
                <div class="manager-label">Import / Export</div>
                <div class="manager-row">
                  <button
                    id="importZipBtn"
                    class="btn"
                    data-tutorial-title="Import ZIP"
                    data-tutorial="Load a ZIP file into the current project."
                  >Import ZIP</button>
                  <button
                    id="exportZipBtn"
                    class="btn"
                    data-tutorial-title="Export ZIP"
                    data-tutorial="Download your project as a ZIP archive."
                  >Export ZIP</button>
                </div>
              </div>
            </div>
          </div>
          <button
            id="publishBtn"
            class="btn btn-primary"
            data-tutorial-title="Publish"
            data-tutorial="Send this project to the server and get a shareable URL."
          >Publish</button>
          <a
            class="btn"
            href="/projects/index.html"
            target="_blank"
            rel="noopener"
            data-tutorial-title="Published projects"
            data-tutorial="Browse all published projects on this server."
          >Published Projects</a>
          <button
            id="accountBtn"
            class="btn"
            title="Account"
            data-tutorial-title="Account"
            data-tutorial="Sign in to publish projects and manage your account."
          >Guest</button>
        </div>
      </header>

      <main class="workspace" id="workspace">
        <aside
          class="panel file-panel"
          data-tutorial-title="Files pane"
          data-tutorial="Create, upload, and organize files for your project."
        >
          <div class="panel-header">
            <span>Files</span>
            <div class="panel-actions">
              <button
                id="toggleFilePanelBtn"
                class="icon-btn"
                title="Collapse files"
                data-tutorial-title="Collapse files"
                data-tutorial="Hide the file tree to make more room for editing."
              >
                <i data-lucide="chevrons-left"></i>
              </button>
              <button
                id="addFolderBtn"
                class="icon-btn"
                title="New folder"
                data-tutorial-title="New folder"
                data-tutorial="Create a new folder to organize files."
              >
                <i data-lucide="folder-plus"></i>
              </button>
              <button
                id="addFileBtn"
                class="icon-btn"
                title="Add file"
                data-tutorial-title="Add file"
                data-tutorial="Create a new file in the selected folder."
              >
                <i data-lucide="file-plus"></i>
              </button>
              <button
                id="uploadFileBtn"
                class="icon-btn"
                title="Upload files"
                data-tutorial-title="Upload files"
                data-tutorial="Add files from your computer into the project."
              >
                <i data-lucide="upload"></i>
              </button>
            </div>
          </div>
          <div id="fileTree" class="file-tree"></div>
        </aside>

        <section
          class="panel editor-panel"
          data-tutorial-title="Editor pane"
          data-tutorial="Edit your project files here. Formatting and search tools live in the header."
        >
          <div class="panel-header">
            <div class="panel-title">
              <span id="currentFileLabel">Select a file</span>
              <span id="saveStatus" class="status"></span>
            </div>
            <div class="panel-actions">
              <button
                id="expandFilePanelBtn"
                class="icon-btn hidden"
                title="Show files"
                data-tutorial-title="Show files"
                data-tutorial="Bring the file list back if it is hidden."
              >
                <i data-lucide="folder-open"></i>
              </button>
              <button
                id="undoBtn"
                class="icon-btn"
                title="Undo last change"
                data-tutorial-title="Undo"
                data-tutorial="Step back through recent edits."
              >
                <i data-lucide="undo-2"></i>
              </button>
              <button
                id="redoBtn"
                class="icon-btn"
                title="Redo last change"
                data-tutorial-title="Redo"
                data-tutorial="Step forward through changes you just undid."
              >
                <i data-lucide="redo-2"></i>
              </button>
              <button
                id="wrapToggleBtn"
                class="icon-btn"
                title="Toggle line wrap"
                data-tutorial-title="Line wrap"
                data-tutorial="Keep long lines wrapped within the editor."
              >
                <i data-lucide="wrap-text"></i>
              </button>
              <button
                id="searchBtn"
                class="icon-btn"
                title="Search"
                data-tutorial-title="Search"
                data-tutorial="Find text in the current file."
              >
                <i data-lucide="search"></i>
              </button>
              <button
                id="foldAllBtn"
                class="icon-btn"
                title="Fold all"
                data-tutorial-title="Fold all"
                data-tutorial="Collapse all code blocks in the editor."
              >
                <i data-lucide="fold-vertical"></i>
              </button>
              <button
                id="unfoldAllBtn"
                class="icon-btn"
                title="Unfold all"
                data-tutorial-title="Unfold all"
                data-tutorial="Expand all code blocks in the editor."
              >
                <i data-lucide="unfold-vertical"></i>
              </button>
              <button
                id="prettifyBtn"
                class="icon-btn"
                title="Format current file"
                data-tutorial-title="Format"
                data-tutorial="Auto-format the current file using Prettier."
              >
                <i data-lucide="wand-2"></i>
              </button>
              <button
                id="editorThemeToggleBtn"
                class="icon-btn"
                title="Toggle editor theme"
                data-tutorial-title="Editor theme"
                data-tutorial="Switch the editor color theme without changing the app theme."
              >
                <i data-lucide="moon-star"></i>
              </button>
            </div>
          </div>
          <div class="editor-wrap">
            <textarea id="editor" class="editor" spellcheck="false"></textarea>
            <div id="binaryNotice" class="binary-notice hidden">
              This file is binary. Preview it in the right panel or replace it.
            </div>
          </div>
        </section>

        <div
          class="splitter"
          id="editorPreviewSplitter"
          role="separator"
          aria-label="Resize editor"
          data-tutorial-title="Resize panes"
          data-tutorial="Drag to resize the editor and preview panes."
        ></div>

        <section
          class="panel preview-panel"
          data-tutorial-title="Preview pane"
          data-tutorial="See your project running live. Use refresh if it looks out of date."
        >
          <div class="panel-header">
            <span>Preview</span>
            <div class="panel-actions">
              <button
                id="refreshPreviewBtn"
                class="icon-btn"
                title="Refresh preview"
                data-tutorial-title="Refresh preview"
                data-tutorial="Reload the preview frame."
              >
                <i data-lucide="refresh-cw"></i>
              </button>
            </div>
          </div>
          <div class="preview-wrap">
            <iframe
              id="previewFrame"
              sandbox="allow-scripts allow-same-origin"
              title="Project Preview"
            ></iframe>
          </div>
          <div id="previewWarnings" class="warnings"></div>
        </section>
      </main>
    </div>

    <input id="zipInput" type="file" accept=".zip,.tgz,.tar.gz" class="hidden" />
    <input id="fileInput" type="file" multiple class="hidden" />

    <div id="newProjectModal" class="modal hidden" role="dialog" aria-label="New project">
      <div class="modal-backdrop"></div>
      <div class="modal-panel">
        <div class="modal-header">
          <span>New project</span>
          <button id="closeNewProjectBtn" class="icon-btn" title="Close">
            <i data-lucide="x"></i>
          </button>
        </div>
        <div class="modal-body">
          <label class="modal-label" for="newProjectNameInput">Project name</label>
          <input id="newProjectNameInput" class="modal-input" type="text" placeholder="Project name" />
          <label class="modal-label checkbox-row">
            <input id="includeStarterFilesInput" type="checkbox" checked />
            Include starter files
          </label>
        </div>
        <div class="modal-actions">
          <button id="createProjectBtn" class="btn btn-primary">Create</button>
        </div>
      </div>
    </div>

        <div id="projectMetaModal" class="modal hidden" role="dialog" aria-label="Project details">
          <div class="modal-backdrop"></div>
          <div class="modal-panel">
            <div class="modal-header">
              <span>Project details</span>
              <button id="closeProjectMetaBtn" class="icon-btn" title="Close">
                <i data-lucide="x"></i>
              </button>
            </div>
            <div class="modal-body">
              <label class="modal-label" for="projectTitleInput">Project name</label>
              <input id="projectTitleInput" class="modal-input" type="text" placeholder="Project name" />
              <label class="modal-label" for="projectCreatorInput">Creator name</label>
              <input id="projectCreatorInput" class="modal-input" type="text" placeholder="Your name" />
              <label class="modal-label" for="projectDescriptionInput">Project description</label>
              <textarea id="projectDescriptionInput" class="modal-textarea" placeholder="Short description"></textarea>
            </div>
        <div class="modal-actions">
          <button id="saveProjectMetaBtn" class="btn">Save</button>
        </div>
      </div>
    </div>

    <div id="publishModal" class="modal hidden" role="dialog" aria-label="Publish complete">
      <div class="modal-backdrop"></div>
      <div class="modal-panel">
        <div class="modal-header">
          <span>Published</span>
          <button id="closePublishModalBtn" class="icon-btn" title="Close">
            <i data-lucide="x"></i>
          </button>
        </div>
        <div class="modal-body">
          <p class="modal-text">Your project is live at:</p>
          <div class="modal-url" id="publishUrlText"></div>
        </div>
        <div class="modal-actions">
          <button id="copyPublishUrlBtn" class="btn">Copy URL</button>
          <button id="openPublishUrlBtn" class="btn btn-primary">Open</button>
        </div>
      </div>
    </div>

    <div id="accountModal" class="modal hidden" role="dialog" aria-label="Account">
      <div class="modal-backdrop"></div>
      <div class="modal-panel">
        <div class="modal-header">
          <span>Account</span>
          <button id="closeAccountModalBtn" class="icon-btn" title="Close">
            <i data-lucide="x"></i>
          </button>
        </div>
        <div class="modal-body">
          <div id="loginPanel">
            <label class="modal-label" for="loginEmailInput">Email</label>
            <input id="loginEmailInput" class="modal-input" type="email" placeholder="you@example.com" />
            <div class="login-spacer"></div>
            <label class="modal-label" for="loginPasswordInput">Password</label>
            <input id="loginPasswordInput" class="modal-input" type="password" placeholder="Password" />
            <p id="loginError" class="modal-text"></p>
            <p class="modal-text">
              Need an account? Contact your Glitchlet admin.
            </p>
          </div>
          <div id="accountPanel" class="hidden">
            <p class="modal-text" id="accountSummary"></p>
            <div class="modal-actions">
              <a id="accountProjectsLink" class="btn" href="/publish/projects.php">My projects</a>
              <a id="accountManagerLink" class="btn hidden" href="/publish/manager.php">Admin</a>
              <button id="logoutBtn" class="btn">Log out</button>
            </div>
          </div>
        </div>
        <div class="modal-actions" id="loginActions">
          <button id="loginSubmitBtn" class="btn btn-primary">Sign in</button>
        </div>
      </div>
    </div>

    <div id="dialogModal" class="modal hidden" role="dialog" aria-label="Dialog">
      <div class="modal-backdrop"></div>
      <div class="modal-panel">
        <div class="modal-header">
          <span id="dialogTitle">Notice</span>
          <button id="dialogCloseBtn" class="icon-btn" title="Close">
            <i data-lucide="x"></i>
          </button>
        </div>
        <div class="modal-body">
          <p id="dialogMessage" class="modal-text"></p>
          <input id="dialogInput" class="modal-input hidden" type="text" />
        </div>
        <div class="modal-actions">
          <button id="dialogCancelBtn" class="btn">Cancel</button>
          <button id="dialogOkBtn" class="btn btn-primary">OK</button>
        </div>
      </div>
    </div>

    <div id="aboutModal" class="modal hidden" role="dialog" aria-label="About Glitchlet">
      <div class="modal-backdrop"></div>
      <div class="modal-panel">
        <div class="modal-header">
          <span>About Glitchlet</span>
          <button id="closeAboutBtn" class="icon-btn" title="Close">
            <i data-lucide="x"></i>
          </button>
        </div>
        <div class="modal-body">
          <p class="modal-text">
            Glitchlet is a lightweight, browser-based creative coding environment for building
            small HTML/CSS/JS projects with instant preview.
          </p>
          <p class="modal-text">
            Created by Mark Sample to help students and hobbyists publish and remix web projects.
          </p>
          <p class="modal-text modal-version">
            Version: <span id="aboutVersion">--</span>
          </p>
          <p class="modal-text">
            Source: <a class="modal-link" href="https://github.com/samplereality/glitchlet/" target="_blank" rel="noopener">github.com/samplereality/glitchlet</a>
          </p>
        </div>
        <div class="modal-actions">
          <button id="dismissAboutBtn" class="btn btn-primary">Got it</button>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/lib/codemirror.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/xml/xml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/javascript/javascript.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/css/css.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/htmlmixed/htmlmixed.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/edit/matchbrackets.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/edit/closebrackets.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/edit/closetag.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/foldcode.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/foldgutter.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/brace-fold.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/indent-fold.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/comment-fold.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/xml-fold.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/markdown-fold.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/javascript-fold.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/search/searchcursor.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/search/search.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/dialog/dialog.js"></script>
    <script src="https://unpkg.com/prettier@3.8.0/standalone.js"></script>
    <script src="https://unpkg.com/prettier@3.8.0/plugins/babel.js"></script>
    <script src="https://unpkg.com/prettier@3.8.0/plugins/estree.js"></script>
    <script src="https://unpkg.com/prettier@3.8.0/plugins/html.js"></script>
    <script src="https://unpkg.com/prettier@3.8.0/plugins/postcss.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="assets/version.js"></script>
    <script src="assets/app.js"></script>
  </body>
</html>
